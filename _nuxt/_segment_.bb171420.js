import{_ as oe}from"./breadCrumbs.ffbcaef2.js";import{_ as se}from"./Header.7ce4e911.js";import{V as i,j as ae,au as re,f as le,k as ie,aw as ce,aO as B,h as C,aP as ue,ay as de,g as pe,aQ as me,L as S,c as x,b as y,a as e,i as l,D as b,F as fe,s as _e,v as ye,t as D,ab as g,o as R}from"./entry.e1c54084.js";import be from"./_snb.5c7ca73e.js";import ge from"./_snbTablet.5be258ab.js";import{T as ve}from"./index.e40167c5.js";import{c as he,a as $}from"./index.esm.a3631549.js";import"./title.fb65f11f.js";import"./1.5c1c421a.js";const q=()=>{const v={files:i([]),maxFileSize:i(0),maxFileCount:i(0),fileExt:i([]),setProps:(d,p)=>{try{v[d].value=p}catch(c){console.error(c)}}};return{...v}},Ee={class:"mypage"},Ce={class:"mypage-share__write"},Se={class:"mypage__wrap"},xe={class:"mypage__contents"},Re={class:"mypage__contents-body"},ke={class:"mypage__contents-wrigite"},Te={class:"c-form-group"},we=e("label",{for:"title",class:"c-form-label"},"제목",-1),Me=e("div",{class:"c-form-group"},[e("label",{for:"contents",class:"c-form-label"},"내용"),e("div",{id:"contents"})],-1),Fe={class:"c-form-group"},Ie=e("label",{for:"file",class:"c-form-label"},"파일 첨부",-1),Ne={class:"c-input-group"},Oe=["onClick"],Le=["innerHTML"],Be={class:"c-form-file"},De=["onClick"],$e=e("i",{class:"ico ico-delete"},"삭제",-1),qe=[$e],Ae={class:"c-btn-group"},Pe={type:"submit",class:"c-btn c-btn-lg c-btn-danger"},Qe={__name:"[segment]",async setup(v){let d,p;const{params:{mode:c,segment:k},query:{seq:T}}=ae(),{EDITOR_OPTIONS:A,MENTORING:{MENTORING_BOARD_WRITE:P,MENTORING_BOARD_MASTER_SPECS:V,MENTORING_BOARD_VIEW:j}}=re(),{push:w,go:G}=le(),u=ie(),{maxFileSize:U,maxFileCount:M,setProps:F}=q();let{files:a,fileExt:h}=q();const{values:I,setFieldValue:m,handleSubmit:z,meta:H,setFieldTouched:W}=ce({validationSchema:he({title:$().min(2).required(),content:$().min(10).required()})}),N=i(!1),E=i(null),O=i(null),K=i(null);let f=null;const Y=n=>{try{const[t]=n.target.files,{size:s,type:r}=t;if(!h.value.includes(r.match(/(\w+$)/g)[0].toUpperCase())){u.open({key:g("alert"),type:"alert",title:"알림",message:"파일등록이 불가능한 확장자입니다. 파일을 <br/>확인 후 다시 시도해주시길 바랍니다",buttons:[{text:"확인",styleType:"danger"}]}),n.target.files=null;return}if(s>=U){u.open({key:g("alert"),type:"alert",title:"알림",message:"정의안됨: 파일용량 제어",buttons:[{text:"확인",styleType:"danger"}]}),n.target.files=null;return}if(a.value.length===M.value){u.alert("알림","정의 안됨 : 파일허용개수 초과"),n.target.files=null;return}a.value.push(t),n.target.files=null}catch{}},J=()=>{O.value.click()},Q=n=>{a.value=a.value.filter(t=>t!==n)},L=z(async n=>{try{const{content:t,...s}=n,r={...s};Object.assign(r,{boardMastSeq:B(k),secretYn:"Y",content:f.getHTML(),boardSeq:T});const o=new FormData;o.append("board",JSON.stringify(r)),a.value.length>=1&&a.value.forEach(_=>o.append("files",_)),await C({id:`멘토링 커뮤니티 - 게시판 글 작성 및 수정 ${c}`,endpoint:P,method:c==="modify"?"put":"post",data:o,headers:"FILE_UPLOAD",onResponse:()=>{N.value=!0,w("/mypage/community/board/list/share")}})}catch(t){console.error(t)}},({errors:n})=>{const[t]=Object.entries(n),[s,r]=t;switch(s){case"title":{u.open({key:g("alert"),type:"alert",title:"알림",message:"제목은 2글자 이상 작성하셔야 합니다",onClose:()=>E.value.focus(),buttons:[{text:"확인",styleType:"danger"}]});break}case"content":{u.open({key:g("alert"),type:"alert",title:"알림",message:"내용은 10글자 이상 작성하셔야 합니다",onClose:()=>{const{wwEditor:o}=f.getEditorElements();o.querySelector(".toastui-editor-contents").focus()},buttons:[{text:"확인",styleType:"danger"}]});break}}}),X=()=>{f=new ve({...A("#contents"),initialValue:I.content,events:{change(n){m("content",f.getMarkdown())}}}),E.value.value=I.title||""},Z=async()=>{W({title:!0,content:!0}),c!=="write"&&await C({id:"멘토링 커뮤니티 - 게시판 데이터 읽어오기",endpoint:j.replace(/{boardSeq}/,T),onResponse:({data:n})=>{const{title:t,description:s,fileInfo:r,updatable:o}=n;if(o===!1){u.alert("알림","자신의 글 외에는 수정할 수 없습니다.",()=>G(-1));return}m("title",t),m("content",s),r.forEach(({originFileName:_})=>{a.value.push({name:_})})}})};ue(()=>{C({id:"멘토링 커뮤니티 - 게시판 마스터 스펙 코드",endpoint:V,data:{boardMastCate:B(k)},onResponse:({data:{attaFileAllowCnt:n,attaFileMaxSize:t,attaFileUseExt:s}})=>{F("maxFileSize",1024*1024*t),F("maxFileCount",n),h.value=[].concat(s.split(","))}})}),[d,p]=de(()=>Z()),await d,p(),pe(()=>X()),me(()=>ne.value===!0?N.value===!0?!0:confirm("이미 작성된 내용이 있습니다. 확인 버튼을 누르시면, 작성내용이 사라지고 목록으로 이동합니다"):!0);const ee=S(()=>`${h.value.join(",").toLowerCase()}<br />형식으로 최대 ${M.value}개 첨부 가능`),te=S(()=>c==="modify"?"수정하기":"등록하기"),ne=S(()=>H.value.dirty);return(n,t)=>{const s=oe,r=se;return R(),x("div",Ee,[y(ge,{currentUrl:"/mypage/community/board/list/share"}),y(s),e("div",Ce,[e("div",Se,[y(be,{currentUrl:"/mypage/community/board/list/share"}),e("div",xe,[y(r),e("div",Re,[e("div",ke,[e("form",{onSubmit:t[3]||(t[3]=(...o)=>l(L)&&l(L)(...o))},[e("fieldset",null,[e("div",Te,[we,e("input",{type:"text",class:"c-form-control",placeholder:"제목을 입력해주세요.",ref_key:"titleRef",ref:E,id:"title",name:"title",onChange:t[0]||(t[0]=o=>l(m)("title",o.target.value))},null,544)]),Me,e("div",Fe,[Ie,e("div",Ne,[e("input",{type:"file",id:"file",ref_key:"inputRef",ref:O,style:{display:"none"},onChange:Y},null,544),e("input",{class:"c-form-control",type:"text",placeholder:"파일 첨부해주세요.",ref_key:"displayInputRef",ref:K},null,512),e("button",{type:"button",class:"c-btn c-btn-sm c-btn-blue",onClick:b(J,["prevent"])}," 파일 선택 ",8,Oe)]),e("div",{class:"c-text-caution",innerHTML:l(ee)},null,8,Le),l(a)?(R(!0),x(fe,{key:0},_e(l(a),(o,_)=>(R(),x("div",Be,[e("a",{href:"#",onClick:t[1]||(t[1]=b(()=>{},["prevent"]))},D(o.name),1),e("button",{type:"button",onClick:b(()=>Q(o),["prevent"])},qe,8,De)]))),256)):ye("",!0)]),e("div",Ae,[e("button",{type:"button",class:"c-btn c-btn-lg c-btn-blue",onClick:t[2]||(t[2]=b(o=>l(w)({path:"/mypage/community/board/list/share"}),["prevent"]))}," 취소하기 "),e("button",Pe,D(l(te)),1)])])],32)])])])])])])}}};export{Qe as default};
