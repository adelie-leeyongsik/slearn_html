import{_ as D}from"./CommonContentsModal.1a643f7e.js";import{k as B,ak as L,O as P,r as O,l as _,Q as R,L as F,Z as h,c as f,b as r,w as v,i as a,a as t,D as G,d as b,t as w,y as p,z as y,S as J,F as Q,s as W,E as g,v as Z,B as E,h as k,am as q,J as H,o as c,U as K,x as X}from"./entry.e1c54084.js";import{_ as j}from"./Input.9ccbf189.js";import{_ as ee}from"./Countdown.669033c6.js";import{_ as ae}from"./ic-check.70858d0c.js";import{u as te}from"./vue-daum-postcode.7b75c6e7.js";const le={class:"mypage__contents-body"},oe={class:"mypage__form-wrap"},se={class:"mypage__form"},ie={class:"mypage__form-profile"},ne=["src"],de={class:"c-form-group"},me=t("label",{for:"name",class:"c-form-label"},"이름",-1),re=["value"],ce={class:"c-form-group"},ue={for:"joinDate",class:"c-form-label"},pe={class:"c-form-label__date"},fe=["value"],be={class:"c-form-group"},_e=t("label",{for:"identification",class:"c-form-label"},"아이디",-1),ve=["value"],ye={class:"c-form-group"},he=t("label",{class:"c-form-label"},"이메일 주소",-1),ge={class:"c-input-group c-input-group--email"},ke=["value"],Ce={key:0,class:"c-text-caution c-text-caution--type02 c-text-danger"},Ne={key:0,class:"c-text-primary"},Ve=t("span",{counter:""},"00:00",-1),xe=[Ve],$e={key:1,class:"c-text-primary"},we=t("img",{src:ae,alt:"확인완료"},null,-1),Ee={class:"c-form-group"},ze=t("label",{class:"c-form-label"},"주소",-1),Ie={class:"c-input-group c-input-group--disabled"},Te={class:"c-input-group"},Ye={class:"c-input-group"},Me={class:"c-form-group"},Se=t("label",{for:"cellmobileno",class:"c-form-label"},"휴대폰번호",-1),Ue={class:"c-input-group"},Ae={class:"c-form-group"},De=t("div",{class:"c-form-label"},"이벤트 문자 수신 정보",-1),Be={class:"c-form-check-group"},Le={class:"c-form-check"},Pe=["checked"],Oe=t("label",{class:"c-btn c-btn-lg c-btn-block c-btn-outline-secondary",for:"eventYes"},"수신",-1),Re={class:"c-form-check"},Fe=["checked"],Ge=t("label",{class:"c-btn c-btn-lg c-btn-block c-btn-outline-secondary",for:"eventNo"},"미수신",-1),Je=t("div",{class:"c-text-caution"},[b(" 서울형교육플랫폼서비스 이용회원은 학습정보, 운영에 대한 등의 정보는 "),t("br"),b(" 문자/이메일 등으로 전송됩니다. ")],-1),Xe={__name:"_updateBody",props:{data:{profile:"",userName:"",loginid:"",zipcode:"",email:"",address1:"",address2:"",mobileno:"",smsYn:""}},setup(z){const i=z,d=B(),C=L(),I=P(),e=O({data:{profile:_.isEmpty(i.data.profile)?"1":i.data.profile,address1:i.data.address1,address2:i.data.address2,mobileno:i.data.mobileno,zipcode:i.data.zipcode,smsYn:i.data.smsYn},addressModal:{isShow:!1,title:"주소 찾기",id:"",isAgree:""},email:{value:_.isEmpty(i.data.email)?"":i.data.email.split("@")[0],isConfirm:!0,isNew:!1,domain:_.isEmpty(i.data.email)?"":i.data.email.split("@")[1],timeStatus:"start",isEnd:!1,remainingTime:"",domainArr:R(),authNum:"",authInputNum:"",checkDup:!1},mobileno:{value:i.data.mobileno,value1:i.data.mobileno.split("-")[0],value2:i.data.mobileno.split("-")[1],value3:i.data.mobileno.split("-")[2],isConfirm:!0,isNew:!1,remainingTime:"",timer:""},confirmValidator:F(()=>e.email.isConfirm&&e.mobileno.isConfirm)});h(()=>I.passInfo,s=>{_.isEmpty(s)||(s.MOBILE_NO===e.mobileno.value?Number(X("age"))>=14&&s.NAME!=i.data.userName?d.alert("","가입하신 회원의 휴대폰 번호로 인증하여 주시기 바랍니다."):(d.alert("알림","인증이 완료되었습니다."),e.mobileno.isConfirm=!0,e.mobileno.isNew=!1):d.alert("알림","입력하신 휴대폰 번호와 인증받은 휴대폰 번호가 일치하지 않습니다. 확인 후 다시 시도해주시길 바랍니다."))}),h(()=>({email:`${e.email.value}@${e.email.domain}`}),s=>{N(s.email,i.data.email,e.email)}),h(()=>e.mobileno.value1+e.mobileno.value2+e.mobileno.value3,s=>{e.mobileno.value=`${e.mobileno.value1}-${e.mobileno.value2}-${e.mobileno.value3}`,N(s,i.data.mobileno.replaceAll("-",""),e.mobileno)});const N=(s,l,n)=>{s!==l?(n.isNew=!0,n.isConfirm=!1,n.checkDup=!1,e.email.remainingTime=""):(n.isNew=!1,n.isConfirm=!0,n.checkDup=!0)},T=async(s,l)=>{let n,m;s==="email"?(n="/api/ident_by_email",m={email:e.email.value+"@"+e.email.domain}):(n="/api/ident_by_mobileno",m={mobileno:e.mobileno.value.replaceAll("-","")}),console.log(">>>>>>>>>>>",m),await k({id:"회원정보 변경 인증번호 발송",endpoint:n,headers:"PUBLIC",method:"post",data:m,onResponse({data:u}){console.log("인증번호 발송 >>>",u),l.isConfirm=!1,l.authNum=u.crtfNumber,l.timeStatus=l.timeStatus==="start"?"restart":"start",l.remainingTime=180}})},V=async()=>{await k({id:"회원정보변경 이메일 중복 검사",endpoint:"/api/member_info/email_dup_check",headers:"PUBLIC",method:"post",data:{email:`${e.email.value}@${e.email.domain}`},onResponse({data:s}){if(console.log(s),s.dupYn==="Y"){d.alert("알림","이메일이 중복됩니다. 확인 후 다시 시도해주시길 바랍니다."),e.email.checkDup=!1;return}e.email.checkDup=!0}})},x=async s=>{s.target.value==="cancel"?d.confirm("취소","취소하실 경우 수정한 내역이 사라집니다.<br/> 취소하시겠습니까?",()=>{C.emit("confirm")}):(console.log(e.confirmValidator),e.confirmValidator?Y():d.alert("","휴대폰 번호 또는 이메일은 변경 후 인증이 필요합니다.<br/>인증 후 다시 시도해주시길 바랍니다."))},Y=async()=>{await k({id:"회원정보 수정",endpoint:"/api/member_info/post",headers:"LOGIN",method:"post",data:{profile:e.data.profile,email:`${e.email.value}@${e.email.domain}`,address1:e.data.address1,address2:e.data.address2,mobileno:e.mobileno.value,smsYn:e.data.smsYn,zipcode:e.data.zipcode},onResponse({data:s}){return d.alert("알림","회원정보 수정이 완료되었습니다",()=>{C.emit("confirm")}),!0}})},$=s=>{switch(s){case"email":if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(`${e.email.value}@${e.email.domain}`)){if(V()==="Y"){d.alert("","이메일이 중복됩니다. 확인 후 다시 시도해주시길 바랍니다.");return}}else{d.alert("","이메일 형식이 아닙니다. 확인 후 다시 시도해주시길 바랍니다.");return}e.email.isEnd=!1,T(s,e.email);break;case"mobileno":var l=/^010-\d{3,4}-\d{4}$/;if(!l.test(e.mobileno.value)){d.alert("","핸드폰 번호가 유효하지 않습니다. 확인 후 다시 시도해주시길 바랍니다.");return}q();break}},M=s=>{e.data.address1=s.userSelectedType==="R"?s.roadAddress:s.jibunAddress,e.data.zonecode=s.zonecode,e.addressModal.isShow=!1},S=()=>{e.data.profile=Math.floor(Math.random()*19)+1},U=()=>{e.email.authNum===e.email.authInputNum?d.alert("알림","인증이 완료되었습니다.",()=>{e.email.isConfirm=!0,e.email.timeStatus="stop",e.email.isNew=!1}):d.alert("알림","인증번호가 틀렸습니다. 다시 입력해주십시오.")};return(s,l)=>{const n=D,m=H,u=j,A=ee;return c(),f("div",null,[r(n,{data:a(e).addressModal,onClose:l[0]||(l[0]=o=>a(e).addressModal.isShow=!1)},{innerContents:v(()=>[r(a(te),{onComplete:M})]),_:1},8,["data"]),t("div",le,[t("div",oe,[t("div",se,[t("form",{class:"needs-validation",onSubmit:l[18]||(l[18]=G(()=>{},["prevent"]))},[t("fieldset",null,[t("div",ie,[t("a",{href:"javascript:void(0);",onClick:S,class:"mypage__form-profile-img mypage__form-profile-img--edit"},[t("img",{ref:"myImage",src:("uImage"in s?s.uImage:a(K))(`@temp/${a(e).data.profile}.jpg`),alt:"회원 프로필 이미지"},null,8,ne)])]),t("div",de,[me,t("input",{type:"text",id:"name",class:"c-form-control",value:i.data.userName,readonly:""},null,8,re)]),t("div",ce,[t("label",ue,[b("가입일"),t("span",pe,"("+w(i.data.regDtm)+" 평생교육 포털 제공 동의)",1)]),t("input",{type:"text",id:"joinDate",class:"c-form-control",value:i.data.regDtm,readonly:""},null,8,fe)]),t("div",be,[_e,t("input",{id:"identification",type:"text",class:"c-form-control",value:("isEmpty"in s?s.isEmpty:a(_.isEmpty))(i.data.sll_Id)?i.data.loginid:i.data.sll_Id,readonly:""},null,8,ve)]),t("div",ye,[he,t("div",ge,[p(t("input",{id:"emailAddress",class:"c-form-control",type:"text",placeholder:"이메일 주소",title:"이메일주소 입력","onUpdate:modelValue":l[1]||(l[1]=o=>a(e).email.value=o)},null,512),[[y,a(e).email.value]]),p(t("select",{title:"이메일 도메인 입력",class:"c-form-control","onUpdate:modelValue":l[2]||(l[2]=o=>a(e).email.domain=o)},[(c(!0),f(Q,null,W(a(e).email.domainArr,o=>(c(),f("option",{value:o.value},w(o.text),9,ke))),256))],512),[[J,a(e).email.domain]])]),r(u,{modelValue:a(e).email.domain,"onUpdate:modelValue":l[5]||(l[5]=o=>a(e).email.domain=o),title:"이메일 도메인",placeholder:"이메일 도메인 입력",readonly:a(e).email.domainArr.indexOf(a(e).email.domain)>=0},{default:v(()=>[a(e).email.checkDup==!1?(c(),g(m,{key:0,size:"auto",sizeType:"small",text:"이메일 중복 확인",validator:a(e).email.isNew,disabled:a(e).email.isConfirm,styleType:"primary",onClick:l[3]||(l[3]=o=>V())},null,8,["validator","disabled"])):(c(),g(m,{key:1,size:"auto",sizeType:"small",text:a(e).email.remainingTime!==""?"인증번호 재발송":"인증번호 발송",validator:a(e).email.isNew,disabled:a(e).email.isConfirm,styleType:"primary",onClick:l[4]||(l[4]=o=>$("email"))},null,8,["text","validator","disabled"]))]),_:1},8,["modelValue","readonly"]),a(e).email.isEnd&&!a(e).email.isConfirm?(c(),f("div",Ce," * 입력시간이 초과하였습니다. ")):a(e).email.remainingTime!==""?(c(),g(u,{key:1,modelValue:a(e).email.authInputNum,"onUpdate:modelValue":l[7]||(l[7]=o=>a(e).email.authInputNum=o),title:"인증번호",placeholder:"인증번호를 입력해주세요."},{default:v(()=>[r(A,{command:a(e).email.timeStatus,seconds:a(e).email.remainingTime,onEnd:()=>{a(e).email.isEnd=!0}},{default:v(()=>[a(e).email.isConfirm?(c(),f("p",$e,[we,b(" 확인완료 ")])):(c(),f("p",Ne,xe))]),_:1},8,["command","seconds","onEnd"]),r(m,{size:"auto",styleType:"primary",sizeType:"small",text:"인증번호 확인",onClick:l[6]||(l[6]=o=>U()),validator:!a(e).email.isConfirm,disabled:a(e).email.isConfirm},null,8,["validator","disabled"])]),_:1},8,["modelValue"])):Z("",!0),t("div",Ee,[ze,t("div",Ie,[p(t("input",{class:"c-form-control",type:"text",placeholder:"우편번호",title:"우편번호","onUpdate:modelValue":l[8]||(l[8]=o=>a(e).data.zipcode=o),disabled:""},null,512),[[y,a(e).data.zipcode]]),t("button",{type:"submit",class:"c-btn c-btn-sm c-btn-sm--type02 c-btn-primary",onClick:l[9]||(l[9]=o=>a(e).addressModal.isShow=!0)}," 검색 ")]),t("div",Te,[p(t("input",{class:"c-form-control",type:"text",placeholder:"",title:"주소","onUpdate:modelValue":l[10]||(l[10]=o=>a(e).data.address1=o),disabled:""},null,512),[[y,a(e).data.address1]])]),t("div",Ye,[p(t("input",{class:"c-form-control",type:"text",placeholder:"상세 주소 입력해주세요",title:"상세주소","onUpdate:modelValue":l[11]||(l[11]=o=>a(e).data.address2=o)},null,512),[[y,a(e).data.address2]])])]),t("div",Me,[Se,t("div",Ue,[r(u,{modelValue:a(e).mobileno.value1,"onUpdate:modelValue":l[12]||(l[12]=o=>a(e).mobileno.value1=o),onlyNumber:!0,maxlength:"3",title:"휴대폰 앞번호"},null,8,["modelValue"]),b("- "),r(u,{modelValue:a(e).mobileno.value2,"onUpdate:modelValue":l[13]||(l[13]=o=>a(e).mobileno.value2=o),onlyNumber:!0,maxlength:"4",title:"휴대폰 중간번호"},null,8,["modelValue"]),b("- "),r(u,{modelValue:a(e).mobileno.value3,"onUpdate:modelValue":l[14]||(l[14]=o=>a(e).mobileno.value3=o),onlyNumber:!0,maxlength:"4",title:"휴대폰 끝번호"},null,8,["modelValue"]),r(m,{size:"auto",sizeType:"small",text:"휴대폰으로 인증",validator:a(e).mobileno.isNew,styleType:"primary",onClick:l[15]||(l[15]=o=>$("mobileno")),disabled:a(e).mobileno.isConfirm},null,8,["validator","disabled"])])]),t("div",Ae,[De,t("div",Be,[t("div",Le,[p(t("input",{class:"c-btn-check",type:"radio",name:"event",id:"eventYes",value:"Y","onUpdate:modelValue":l[16]||(l[16]=o=>a(e).data.smsYn=o),checked:i.data.smsYn==="Y"},null,8,Pe),[[E,a(e).data.smsYn]]),Oe]),t("div",Re,[p(t("input",{class:"c-btn-check",type:"radio",name:"event",id:"eventNo",value:"N","onUpdate:modelValue":l[17]||(l[17]=o=>a(e).data.smsYn=o),checked:i.data.smsYn==="N"},null,8,Fe),[[E,a(e).data.smsYn]]),Ge])]),Je])]),t("div",{class:"c-btn-group"},[t("button",{type:"submit",class:"c-btn c-btn-lg c-btn-primary",value:"cancel",onClick:x}," 취소 "),t("button",{type:"submit",class:"c-btn c-btn-lg c-btn-primary",value:"confirm",onClick:x}," 수정 완료 ")])])],32)])])])])}}};export{Xe as default};
