import{_ as S}from"./CommonContentsModal.1a643f7e.js";import{k as x,ak as $,L as u,r as E,g as B,Z as F,h as m,l as T,E as K,w as q,i as a,o,c as l,a as s,F as g,s as _,n as v,t as D}from"./entry.e1c54084.js";import{_ as L}from"./ch-management.fd76c6e1.js";const P={key:0,class:"c-modals__interest"},R=s("div",{class:"c-modals__interest-img"},[s("img",{src:L,alt:"나의 관심사 찾기"})],-1),z=s("div",{class:"c-modals__interest-text"},[s("ul",null,[s("li",null,[s("span",null,"1"),s("p",null,"하단 시작 버튼을 눌러주세요.")]),s("li",null,[s("span",null,"2"),s("p",null,"선호하는 이미지를 선택해주세요.")]),s("li",null,[s("span",null,"3"),s("p",null,"AI 서울런에서 추천된 컨텐츠를 확인하세요")])])],-1),U=[R,z],V={key:1,class:"c-modals__interest-select"},Z={class:"c-modals__interest-select-img"},j=["onClick"],G=["src"],H={key:2,class:"c-modals__interest-chips"},J=["onClick"],O={key:3,class:"c-modals__button"},Q={class:"c-btn-group"},W={key:4,class:"c-modals__button"},X={class:"c-btn-group"},se={__name:"interestModal",props:{isShow:{type:Boolean,default:null}},setup(y){const f=y,c=x(),k=$(),d=u(()=>f.isShow),e=E({type:"prev",stageNum:1,activeKeywordCnt:u(()=>e.data.keywords.filter(t=>t.isActive===!0).length),activeImgCnt:u(()=>e.data.preferImages[e.stageNum-1].filter(t=>t.isActive===!0).length),preModal:{isShow:d,title:"나의 관심사 찾기",subTitle:"이미지로 나도 몰랐던 선호 주제를 찾아봅니다.",description:"이미지 선택 선호 주제 설문이란? <br/> 사용자의 관심사를 선호하는 이미지와 매칭하여 추천을 위해 진행되는 약식 설문입니다."},imgModal:{isShow:d,title:"나의 관심사 찾기",subTitle:"다음 중 선호하는 이미지를 선택해주세요(<span class='c-text-danger'>1</span>/5)",description:"제시된 이미지 중 선호하는 이미지를 3개 선택해주세요."},keywordModal:{isShow:d,title:"나의 관심사 찾기",subTitle:"정책 정보에 관심이 있으신가요?",description:"평소에 궁금했던 지원사업이나 정책 정보와 관련된 키워드를 선택해 주세요. (최대 2가지)"},data:{preferImages:[],keywords:[]}});B(()=>{h()}),F(()=>e.stageNum,t=>{e.imgModal.subTitle=`다음 중 선호하는 이미지를 선택해주세요(<span class='c-text-danger'>${t}</span>/${e.data.preferImages.length})`});const h=async()=>{await m({id:"관심사 이미지 불러오기",endpoint:"/api/sq/prefer/images",data:{age:T.isEmpty(sessionStorage.getItem("age"))?"":sessionStorage.getItem("age")},onResponse({data:t}){return console.log("관심사 이미지 불러오기",t),e.data=t,!0}})},b=t=>{if(t.isActive=!t.isActive,e.activeImgCnt>3){c.alert("알림","사진은 3개 이상 선택하실 수 없습니다."),t.isActive=!1;return}},C=t=>{if(t.isActive=!t.isActive,e.activeKeywordCnt>2){c.alert("알림","최대 2가지까지 선택하실 수 있습니다."),t.isActive=!1;return}},w=()=>{if(e.type==="keyword"){e.type="img";return}e.stageNum<=1?e.type="prev":--e.stageNum},I=()=>{if(e.activeImgCnt<3){c.alert("알림","제시된 이미지 중 선호하는 이미지를 3개 선택해주세요.");return}if(e.stageNum===e.data.preferImages.length){e.data.adultFlag?e.type="keyword":p();return}++e.stageNum},A=async()=>{let t=[];console.log(e.data.preferImages);for(let n of e.data.preferImages)n.filter(r=>r.isActive===!0).map(r=>{t.push(r)});await m({id:"관심사 이미지 저장하기",endpoint:"/api/sq/prefer/select",method:"post",data:{selectedImages:t,selectedPolicy:[]},onResponse({data:n}){return c.alert("알림","선택이 완료되었습니다.",()=>{console.log(">>>>>>>>>>>>>>>>>>>>>>>>완료>>>>>>>>>>>>",n),p(n)}),!0}})},p=t=>{e.stageNum=1,e.type="prev",e.data.preferImages.forEach(n=>{n.forEach(r=>{r.isActive=!1})}),k.emit("confirm",t)};return(t,n)=>{const r=S;return o(),K(r,{data:a(e).type==="prev"?a(e).preModal:a(e).type==="keyword"?a(e).keywordModal:a(e).imgModal,onClose:n[3]||(n[3]=i=>p())},{innerContents:q(()=>[a(e).type==="prev"?(o(),l("div",P,U)):a(e).type==="img"?(o(),l("div",V,[s("ul",Z,[(o(!0),l(g,null,_(a(e).data.preferImages[a(e).stageNum-1],(i,M)=>(o(),l("li",{class:v(i.isActive?"active":""),onClick:N=>b(i)},[s("img",{src:i.imageUrl,alt:"로고"},null,8,G)],10,j))),256))])])):(o(),l("div",H,[(o(!0),l(g,null,_(a(e).data.keywords,(i,M)=>(o(),l("button",{class:v(["c-chips",i.isActive?"active":""]),onClick:N=>C(i)}," # "+D(i.text),11,J))),256))])),a(e).type==="prev"?(o(),l("div",O,[s("div",Q,[s("button",{type:"submit",class:"c-btn c-btn-danger",onClick:n[0]||(n[0]=i=>a(e).type="img")}," 진단 시작 ")])])):(o(),l("div",W,[s("div",X,[s("button",{type:"submit",class:"c-btn c-btn-blue",onClick:w}," 이전 "),a(e).stageNum===a(e).data.preferImages.length&&!a(e).data.adultFlag||a(e).type==="keyword"?(o(),l("button",{key:0,type:"submit",class:"c-btn c-btn-danger",onClick:n[1]||(n[1]=i=>A())}," 완료 ")):(o(),l("button",{key:1,type:"submit",class:"c-btn c-btn-danger",onClick:n[2]||(n[2]=i=>I())}," 다음 "))])]))]),_:1},8,["data"])}}};export{se as default};
