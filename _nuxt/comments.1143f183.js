import{_ as j}from"./pagination.86fa1564.js";import{_ as J,k as Q,V as E,r as X,x as Z,g as ee,l as f,af as le,o,c as n,a as l,D as $,d as te,t as d,y as k,A as se,i,v as u,F as _,s as S,z as F,N,ag as M,E as oe,I as ne,h as ie,K as re,p as ce,e as ae}from"./entry.e1c54084.js";import{_ as ue}from"./2.eecac130.js";import{_ as de}from"./ic-reply-noimg.f5ddda7d.js";const y=x=>(ce("data-v-2d40b3d6"),x=x(),ae(),x),me={class:"c-reply-group"},fe={class:"c-form-group"},pe={class:"c-reply__title"},_e={class:"c-form-label c-form-label--lg"},ye={key:0,class:"c-form-check"},he=y(()=>l("label",{for:"replySecret",class:"c-form-check-label"},"비밀글",-1)),ge=y(()=>l("div",{class:"c-form-label"},"URL 첨부 (최대3개)",-1)),be=["onUpdate:modelValue"],ve=y(()=>l("label",{class:"c-form-label",for:"file"},"파일첨부",-1)),ke=y(()=>l("input",{class:"c-form-control",type:"text",id:"file",placeholder:"파일 첨부해주세요.",readonly:!0},null,-1)),xe=y(()=>l("button",{class:"c-btn c-btn-sm c-btn-blue"},"파일 찾기",-1)),Ce={class:"c-form-file"},Ie={href:"#"},Se=["onClick"],Ue=y(()=>l("i",{class:"ico ico-delete"},"삭제",-1)),Ee=[Ue],Fe={class:"c-btn-group c-btn-group-right"},De=["onClick"],Re=y(()=>l("strong",null,"등록하기",-1)),Ye=[Re],Te={key:0,class:"c-reply"},Me=y(()=>l("div",{class:"c-reply__img"},[l("img",{src:ue,alt:"내 댓글 프로필"}),l("div",{class:"c-badge c-badge-danger"},"나")],-1)),qe={key:0,class:"c-reply__text"},we={class:"c-reply__text-head"},Be=y(()=>l("label",{class:"c-form-label",for:"replyfile"},"파일첨부",-1)),Le=y(()=>l("input",{class:"c-form-control",type:"text",placeholder:"파일 첨부해주세요.",readonly:!0,id:"replyfile"},null,-1)),$e=y(()=>l("br",null,null,-1)),Ne={class:"c-btn-group c-btn-group-right"},Ve=["onClick"],Pe={key:1,class:"c-reply__text"},ze={class:"c-reply__text-head"},He=["onClick"],We={key:0,class:"c-reply__text-edit"},Ae=["onClick"],Oe=["onClick"],Ge={class:"c-reply__text-list"},Ke={key:0,class:"c-badge c-badge-lg c-badge-light"},je={key:0},Je=["onClick"],Qe={class:"c-reply__img"},Xe=["alt"],Ze={class:"c-reply__text"},el={class:"c-reply__text-head"},ll={class:"c-reply__text-list"},tl={key:0,class:"c-badge c-badge-lg c-badge-light"},sl={key:0},ol=["onClick"],nl={__name:"comments",props:{data:{default:null},urlCnt:{type:Number,default:0},isUrl:{type:Boolean,default:()=>!1},isFile:{type:Boolean,default:()=>!1},isSecret:{type:Boolean,default:()=>!0},isWrite:{type:Boolean,default:()=>!0},boardSeq:{type:Number,default:0},boardType:{default:null}},emits:["changedPageIndex","handleSubmit","handleModifySubmit","handleDeleteSubmit"],setup(x,{emit:C}){const c=x,g=Q(),I=E(),U=E(null),D=E(),R=E(),e=X({loginUserId:Z("userid"),isCommon:window.location.href.indexOf("event")<0,myReply:!1,myReplyMore:!1,myReplyIdx:0,secretYn:!1,url1:"",url2:"",url3:"",fileInfo:null,fileList:[],fileIndex:"",delFileSeq:"",seqInfo:{},urlTxt:[]});ee(async()=>{f.isEmpty(c.boardType)||(e.fileInfo=await le(c.boardType))});const q=()=>{let t=I.value[0];t.style.height="18px",t.style.height=t.scrollHeight+2+"px"},V=t=>{setTimeout(()=>{var r=document.getElementById(t).value.length;document.getElementById(t).focus(),document.getElementById(t).setSelectionRange(r,r)},100)},P=t=>{e.url1=t.shareUrl1,e.url2=t.shareUrl2,e.url3=t.shareUrl3,e.myReply=!0,V("textarea")},z=t=>{console.log("fileInfo",e.fileInfo);let r=t.target.files[0].size,h=e.fileInfo.attaFileMaxSize*1024*1024;if(r>h)return g.alert("알림",`첨부파일 사이즈는 ${e.fileInfo.attaFileMaxSize}MB 이내로 등록 가능합니다.`),!1;let m=t.target.files[0].name,p=e.fileInfo.attaFileUseExt.split(","),b=m.substr(m.lastIndexOf(".")+1).toUpperCase();return p.filter(s=>s===b).length===0?(g.alert("알림","파일등록이 불가능한 확장자입니다. <br/> 파일을 확인 후 다시 시도해주시길 바랍니다."),!1):e.fileList.length>=e.fileInfo.attaFileAllowCnt?(g.alert("알림",`파일은 ${e.fileInfo.attaFileAllowCnt}개 까지만 등록할 수 있습니다.`),!1):!0},w=t=>{if(z(t)){let h=t.target.files[0];if(e.fileList.length>0){let m=e.fileList.map(p=>p.name).indexOf(h.name);m!=-1&&e.fileList.splice(m,1)}e.fileList.push(h)}else D.value.value=null,R.value.value=null},H=(t,r)=>{e.fileIndex=t,e.delFileSeq=r,g.confirm("알림","파일을 삭제하시겠습니까?",W)},W=()=>{typeof e.delFileSeq<"u"&&(e.delFileList.push(e.delFileSeq),C("onDelFileInfo",e.delFileList)),e.fileList.splice(e.fileIndex,1)},Y=t=>{C("changedPageIndex",t)},A=t=>{if(!e.isCommon){const r={eventSeq:t.eventSeq,comtSeq:t.comtSeq,description:I.value[0].value,secretYn:e.secretYn?"Y":"N",shareUrl1:f.isEmpty(e.url1)?"":e.url1,shareUrl2:f.isEmpty(e.url2)?"":e.url2,shareUrl3:f.isEmpty(e.url3)?"":e.url3,file:e.fileList};C("handleModifySubmit",r),e.myReply=!1;return}T("put",t.comtSeq)},O=async t=>{if(!e.isCommon){C("handleDeleteSubmit",t);return}T("delete",t.comtSeq)},T=(t,r=0)=>{console.log(t,r);let h="",m={},p="";switch(t){case"post":if(m={boardSeq:c.boardSeq,comtDesc:U.value.value},p="등록",f.isEmpty(U.value.value)){g.alert("알림","댓글을 입력해주세요.");return}break;case"put":if(m={comtSeq:r,comtDesc:I.value[0].value},f.isEmpty(I.value[0].value)){g.alert("알림","댓글을 입력해주세요.");return}p="수정";break;case"delete":h=`/${r}`,p="삭제";break}g.confirm("알림",`${p}하시겠습니까?`,async()=>{let b=!0;(t=="put"||t=="post")&&(b=await ne("",m.comtDesc)),b&&await ie({method:t,id:"게시판 정보 API",endpoint:`/api/sq/comment${h}`,data:m,onResponse({data:s,status:v}){console.log(s,v),v===200&&(g.alert("알림",`${p}되었습니다.`),t!="put"?Y(0):Y(c.data.pageNumber),e.myReply=!1)}})})},G=()=>{if(!e.isCommon){const t={description:U.value.value,secretYn:e.secretYn?"Y":"N",shareUrl1:f.isEmpty(e.urlTxt[1])?"":e.urlTxt[1],shareUrl2:f.isEmpty(e.urlTxt[2])?"":e.urlTxt[2],shareUrl3:f.isEmpty(e.urlTxt[3])?"":e.urlTxt[3],file:e.fileList};C("handleSubmit",t);return}T("post")},B=t=>{console.log("onClickFileDownload",t),re(t.fileSeq)},K=()=>{D.value.click()},L=()=>{R.value.click()};return(t,r)=>{var m,p,b;const h=j;return o(),n(_,null,[l("div",me,[l("form",{action:"",onSubmit:r[1]||(r[1]=$(()=>{},["prevent"]))},[l("fieldset",null,[l("div",fe,[l("legend",null,[l("div",pe,[l("div",_e,[te(" 댓글"),l("span",null,d(c.data.totalRecords),1)]),c.isSecret===!0&&c.isWrite?(o(),n("div",ye,[k(l("input",{"onUpdate:modelValue":r[0]||(r[0]=s=>i(e).secretYn=s),type:"checkbox",class:"c-form-check-input",id:"replySecret"},null,512),[[se,i(e).secretYn]]),he])):u("",!0)])]),c.isWrite?(o(),n("textarea",{key:0,ref_key:"commentRef",ref:U,class:"c-form-control",placeholder:"댓글을 남겨 볼까요? (최대 300글자)",title:"댓글 입력"},null,512)):u("",!0),c.isWrite&&c.urlCnt>0&&c.isUrl?(o(),n(_,{key:1},[ge,(o(!0),n(_,null,S(c.urlCnt,s=>k((o(),n("textarea",{"onUpdate:modelValue":v=>i(e).urlTxt[s]=v,class:"c-form-control c-form-control-sm",placeholder:"주소를 입력해주세요.",title:"댓글 url 입력"},null,8,be)),[[F,i(e).urlTxt[s]]])),256))],64)):u("",!0),c.isFile===!0&&c.isWrite?(o(),n(_,{key:2},[ve,l("div",{class:"c-input-group",onClick:K},[ke,k(l("input",{class:"c-form-control",type:"file",ref_key:"fileUpload",ref:D,title:"파일 첨부",onChange:w},null,544),[[N,!1]]),xe])],64)):u("",!0),i(e).fileList?(o(!0),n(_,{key:3},S(i(e).fileList,(s,v)=>(o(),n("div",Ce,[l("a",Ie,d(s.name),1),l("button",{onClick:a=>H(v)},Ee,8,Se)]))),256)):u("",!0),l("div",Fe,[c.isWrite===!0?(o(),n("button",{key:0,class:"c-btn c-btn-danger",type:"button",onClick:$(G,["prevent"])},Ye,8,De)):u("",!0)])])])],32),c.data?(o(),n("div",Te,[l("ul",null,[(o(!0),n(_,null,S((m=c.data.rows)==null?void 0:m.filter(s=>s.useYn==="Y"),(s,v)=>(o(),n("li",null,[i(e).loginUserId===s.userId?(o(),n(_,{key:0},[Me,i(e).myReply===!0&&i(e).myReplyIdx===s.comtSeq?(o(),n("div",qe,[l("div",we,[l("strong",null,d(s.userId),1),l("span",null,d(("uConvertDateTime"in t?t.uConvertDateTime:i(M))(s.regDtm,"YYYY.MM.DD HH:mm:SS")),1)]),l("textarea",{class:"c-form-control c-form-control-sm",ref_for:!0,ref_key:"textarea",ref:I,id:"textarea",name:"textarea",title:"댓글 내용",onInput:q,onFocus:r[2]||(r[2]=a=>q())},d(s.description),545),c.isUrl===!0?(o(),n(_,{key:0},[k(l("textarea",{"onUpdate:modelValue":r[3]||(r[3]=a=>i(e).url1=a),title:"댓글 url 첫번째",class:"c-form-control c-form-control-sm",placeholder:"주소를 입력해주세요."},null,512),[[F,i(e).url1]]),k(l("textarea",{"onUpdate:modelValue":r[4]||(r[4]=a=>i(e).url2=a),title:"댓글 url 두번째",class:"c-form-control c-form-control-sm",placeholder:"주소를 입력해주세요."},null,512),[[F,i(e).url2]]),k(l("textarea",{"onUpdate:modelValue":r[5]||(r[5]=a=>i(e).url3=a),title:"댓글 url 세번째",class:"c-form-control c-form-control-sm",placeholder:"주소를 입력해주세요."},null,512),[[F,i(e).url3]])],64)):u("",!0),c.isFile===!0?(o(),n(_,{key:1},[Be,l("div",{class:"c-input-group",onClick:L},[Le,k(l("input",{class:"c-form-control",type:"file",title:"파일 첨부",ref_for:!0,ref_key:"replyFileUpload",ref:R,onChange:w},null,544),[[N,!1]]),l("button",{class:"c-btn c-btn-sm c-btn-blue",onClick:L}," 파일 찾기 ")]),$e],64)):u("",!0),l("div",Ne,[l("button",{class:"c-btn c-btn-sm c-btn-blue",onClick:r[6]||(r[6]=a=>i(e).myReply=!1)}," 취소하기 "),l("button",{class:"c-btn c-btn-sm c-btn-danger",onClick:a=>A(s)}," 수정하기 ",8,Ve)])])):(o(),n("div",Pe,[l("div",ze,[l("strong",null,d(s.userId),1),l("span",null,d(("uConvertDateTime"in t?t.uConvertDateTime:i(M))(s.regDtm,"YYYY.MM.DD HH:mm:SS")),1),i(e).loginUserId===s.userId?(o(),n("div",{key:0,class:"c-reply__text-head-more",onClick:()=>{i(e).myReplyMore=!i(e).myReplyMore,i(e).myReplyIdx=s.comtSeq}},[i(e).myReplyMore===!0&&i(e).myReplyIdx===s.comtSeq?(o(),n("ul",We,[l("li",null,[l("button",{class:"c-btn c-btn-text",onClick:a=>P(s)}," 수정하기 ",8,Ae)]),l("li",null,[l("button",{class:"c-btn c-btn-text",onClick:a=>O(s)}," 삭제하기 ",8,Oe)])])):u("",!0)],8,He)):u("",!0)]),l("p",null,d(s.description),1),l("div",Ge,[l("ul",null,[(o(!0),n(_,null,S([s.shareUrl1,s.shareUrl2,s.shareUrl3],a=>(o(),n("li",null,[("isEmpty"in t?t.isEmpty:i(f.isEmpty))(a)?u("",!0):(o(),n("div",Ke,[l("p",null,d(a),1)]))]))),256)),("isEmpty"in t?t.isEmpty:i(f.isEmpty))(s.file)?u("",!0):(o(),n("li",je,[l("button",{class:"c-badge c-badge-lg c-badge-light",onClick:a=>B(s.file)},[l("p",null,d(s.file.origFileName),1)],8,Je)]))])])]))],64)):(o(),n(_,{key:1},[l("div",Qe,[l("img",{src:de,alt:`${s.userId} 프로필 이미지`},null,8,Xe)]),l("div",Ze,[l("div",el,[l("strong",null,d(s.userId),1),l("span",null,d(("uConvertDateTime"in t?t.uConvertDateTime:i(M))(s.regDtm,"YYYY.MM.DD HH:mm")),1)]),l("p",null,d(s.description),1),l("div",ll,[l("ul",null,[(o(!0),n(_,null,S([s.shareUrl1,s.shareUrl2,s.shareUrl3],a=>(o(),n("li",null,[("isEmpty"in t?t.isEmpty:i(f.isEmpty))(a)?u("",!0):(o(),n("div",tl,[l("p",null,d(a),1)]))]))),256)),("isEmpty"in t?t.isEmpty:i(f.isEmpty))(s.file)?u("",!0):(o(),n("li",sl,[l("button",{class:"c-badge c-badge-lg c-badge-light",onClick:a=>B(s.file)},[l("p",null,d(s.file.origFileName),1)],8,ol)]))])])])],64))]))),256))])])):u("",!0)]),((b=(p=c.data)==null?void 0:p.rows)==null?void 0:b.length)>0?(o(),oe(h,{key:0,pageNumber:c.data.pageNumber,totalRecords:c.data.totalRecords,totalPages:c.data.totalPages,onChangedPageIndex:Y},null,8,["pageNumber","totalRecords","totalPages"])):u("",!0)],64)}}},ul=J(nl,[["__scopeId","data-v-2d40b3d6"]]);export{ul as _};
